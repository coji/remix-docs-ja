---
title: useBeforeUnload
toc: false
---

# `useBeforeUnload`

ã“ã®ãƒ•ãƒƒã‚¯ã¯ã€[`window.beforeunload`][window_before_unload] ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼ã«ã™ãŽã¾ã›ã‚“ã€‚

ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã¾ã è¨ªã‚Œã¦ã„ãªã„ãƒšãƒ¼ã‚¸ã¸ã®ãƒªãƒ³ã‚¯ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€Remix ã¯ãã®ãƒšãƒ¼ã‚¸ã®ã‚³ãƒ¼ãƒ‰åˆ†å‰²ã•ã‚ŒãŸãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ä¸­ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã€ã‚ãªãŸã¾ãŸã¯ãƒ›ã‚¹ãƒˆãŒã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰å¤ã„ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ã—ãŸå ´åˆï¼ˆå¤šãã®ãƒ›ã‚¹ãƒˆãŒãã†ã—ã¾ã™ðŸ˜­ï¼‰ã€Remix ã®ãã‚Œã‚‰ã®ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã¸ã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã¯å¤±æ•—ã—ã¾ã™ã€‚Remix ã¯ã€æ–°ã—ã„ URL ã§ãƒ–ãƒ©ã‚¦ã‚¶ã‚’è‡ªå‹•çš„ã«ãƒªãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ã§å›žå¾©ã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰å†é–‹ã•ã‚Œã‚‹ã¯ãšã§ã™ã€‚ã»ã¨ã‚“ã©ã®å ´åˆã€ã“ã‚Œã¯ã†ã¾ãã„ãã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ä½•ã‚‚èµ·ã“ã£ãŸã“ã¨ã«æ°—ã¥ãã¾ã›ã‚“ã€‚

ã“ã®çŠ¶æ³ã§ã¯ã€è‡ªå‹•ãƒšãƒ¼ã‚¸ãƒªãƒ­ãƒ¼ãƒ‰ã«ã‚ˆã£ã¦å¤±ã‚ã‚Œã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹ãƒšãƒ¼ã‚¸ä¸Šã®é‡è¦ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®çŠ¶æ…‹ã‚’ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ã‚ˆã†ãªã‚‚ã®ã«ï¼‰ä¿å­˜ã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚

Remix ã‚’ä½¿ç”¨ã™ã‚‹ã‹ã©ã†ã‹ã«ã‹ã‹ã‚ã‚‰ãšã€ã“ã‚Œã¯è‰¯ã„ç¿’æ…£ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ URL ã‚’å¤‰æ›´ã—ãŸã‚Šã€èª¤ã£ã¦ãƒ–ãƒ©ã‚¦ã‚¶ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã‚’é–‰ã˜ãŸã‚Šã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

```tsx lines=[1,7-11]
import { useBeforeUnload } from "@remix-run/react";

function SomeForm() {
  const [state, setState] = React.useState(null);

  // è‡ªå‹•ãƒšãƒ¼ã‚¸ãƒªãƒ­ãƒ¼ãƒ‰ã®å‰ã«ä¿å­˜
  useBeforeUnload(
    React.useCallback(() => {
      localStorage.stuff = state;
    }, [state])
  );

  // æˆ»ã£ã¦ããŸã¨ãã«èª­ã¿è¾¼ã‚€
  React.useEffect(() => {
    if (state === null && localStorage.stuff != null) {
      setState(localStorage.stuff);
    }
  }, [state]);

  return <>{/*... */}</>;
}
```

[window_before_unload]: https://developer.mozilla.org/en-US/docs/Web/API/Window/beforeunload_event
